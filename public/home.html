<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galaxy Digital Holdings - Complete Platform</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --admin-color: #8e44ad;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 15px 0;
            transition: all 0.3s ease;
            margin-top: 30px;
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.8rem;
            color: white !important;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.85) !important;
            font-weight: 500;
            margin: 0 10px;
            transition: color 0.3s ease;
        }
        
        .nav-link:hover {
            color: white !important;
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 120px 0 100px;
            position: relative;
            overflow: hidden;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB2aWV3Qm94PSIwIDAgMTIwMCA0MDAiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMTIwMCAzMDBjLTEwMCAwLTEwMC0xMDAtMjAwLTEwMHMtMTAwIDEwMC0yMDAgMTAwLTEwMC0xMDAtMjAwLTEwMC0xMDAgMTAwLTIwMCAxMDAtMTAwLTEwMC0yMDAtMTAwLTEwMCAxMDAtMjAwIDEwMFY0MDBoMTIwMFYzMDB6IiBmaWxsPSIjZmZmZmZmIiBmaWxsLW9wYWNpdHk9IjAuMDgiLz48L2c+PC9zdmc+');
            background-size: cover;
        }
        
        .hero-content {
            position: relative;
            z-index: 1;
        }
        
        .hero-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .hero-subtitle {
            font-size: 1.3rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .btn-primary-custom {
            background-color: var(--accent-color);
            border: none;
            padding: 12px 30px;
            font-weight: 600;
            border-radius: 30px;
            transition: all 0.3s ease;
        }
        
        .btn-primary-custom:hover {
            background-color: #c0392b;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .btn-outline-custom {
            border: 2px solid white;
            color: white;
            background: transparent;
            padding: 10px 28px;
            font-weight: 600;
            border-radius: 30px;
            transition: all 0.3s ease;
        }
        
        .btn-outline-custom:hover {
            background: white;
            color: var(--primary-color);
        }
        
        .features-section {
            padding: 100px 0;
        }
        
        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .section-subtitle {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin-bottom: 60px;
        }
        
        .feature-card {
            border: none;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            height: 100%;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .feature-icon {
            font-size: 3rem;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }
        
        .feature-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .footer {
            background-color: var(--primary-color);
            color: white;
            padding: 70px 0 20px;
        }
        
        .footer h5 {
            font-weight: 600;
            margin-bottom: 25px;
            position: relative;
        }
        
        .footer h5::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -10px;
            width: 40px;
            height: 3px;
            background-color: var(--accent-color);
        }
        
        .footer-links {
            list-style: none;
            padding: 0;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .footer-links a:hover {
            color: white;
            padding-left: 5px;
        }
        
        .social-icons a {
            display: inline-block;
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            margin-right: 10px;
            transition: all 0.3s ease;
        }
        
        .social-icons a:hover {
            background-color: var(--accent-color);
            transform: translateY(-5px);
        }
        
        .copyright {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
            margin-top: 40px;
            text-align: center;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
        }
        
        /* Modal Styles */
        .modal-content {
            border-radius: 10px;
            border: none;
        }
        
        .modal-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0;
        }
        
        .btn-close {
            filter: invert(1);
        }
        
        /* Dashboard Styles */
        .dashboard-section {
            padding: 100px 0 50px;
            min-height: 100vh;
            background-color: #f8f9fa;
        }
        
        .dashboard-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .dashboard-card .card-body {
            padding: 30px;
        }
        
        .balance-card {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
        }
        
        .balance-amount {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 15px 0;
        }
        
        .user-welcome {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 30px;
            color: var(--primary-color);
        }
        
        /* Form Styles */
        .form-control:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }
        
        .alert {
            border-radius: 10px;
            border: none;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        /* Page Styles */
        .page-container {
            display: none;
        }
        
        .page-container.active {
            display: block;
        }
        
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            padding: 20px;
        }
        
        .auth-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            padding: 40px;
        }
        
        .auth-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 30px;
            text-align: center;
        }
        
        /* Investment Plans */
        .plan-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            margin-bottom: 30px;
            cursor: pointer;
        }
        
        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .plan-card.basic {
            border-top: 4px solid #3498db;
        }
        
        .plan-card.premium {
            border-top: 4px solid #f39c12;
        }
        
        .plan-card.vip {
            border-top: 4px solid #9b59b6;
        }
        
        .plan-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .plan-body {
            padding: 20px;
        }
        
        .plan-features {
            list-style: none;
            padding: 0;
        }
        
        .plan-features li {
            padding: 8px 0;
            border-bottom: 1px solid #f8f9fa;
        }
        
        .plan-features li:last-child {
            border-bottom: none;
        }
        
        .wallet-address {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 10px;
            font-family: monospace;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .wallet-address:hover {
            background-color: #e9ecef;
        }
        
        .wallet-address.copied {
            background-color: #d4edda;
            color: #155724;
        }
        
        /* Transaction History */
        .transaction-item {
            border-bottom: 1px solid #eee;
            padding: 15px 0;
        }
        
        .transaction-item:last-child {
            border-bottom: none;
        }
        
        .transaction-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-approved {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-rejected {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        /* Dashboard Tabs */
        .dashboard-tabs {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .tab-button {
            background: none;
            border: none;
            padding: 10px 20px;
            margin-right: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .tab-button.active {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Admin Dashboard Styles */
        .admin-dashboard {
            background: linear-gradient(135deg, var(--admin-color) 0%, #6c3483 100%);
            color: white;
            min-height: 100vh;
            padding-top: 80px;
        }
        
        .admin-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            transition: all 0.3s ease;
        }
        
        .admin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .admin-welcome {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
        }
        
        .stat-card {
            text-align: center;
            padding: 20px;
        }
        
        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .admin-table {
            background: white;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .admin-table th {
            background-color: var(--admin-color);
            color: white;
            border: none;
        }
        
        .admin-table td {
            vertical-align: middle;
        }
        
        .action-buttons .btn {
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        /* Marquee Styles */
        .crypto-marquee {
            background: linear-gradient(90deg, #1a1a2e, #16213e, #0f3460);
            color: white;
            padding: 10px 0;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 9999;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .crypto-item {
            display: inline-block;
            margin: 0 20px;
            padding: 5px 10px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .crypto-symbol {
            font-weight: bold;
            margin-right: 5px;
        }
        
        .crypto-price.up {
            color: #2ecc71;
        }
        
        .crypto-price.down {
            color: #e74c3c;
        }
        
        /* Notification Styles */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .notification-item {
            border-left: 4px solid var(--secondary-color);
            padding-left: 15px;
            margin-bottom: 15px;
        }
        
        .notification-item.unread {
            border-left-color: var(--accent-color);
            background-color: rgba(231, 76, 60, 0.05);
        }
        
        .notification-item.important {
            border-left-color: #f39c12;
            background-color: rgba(243, 156, 18, 0.05);
        }
        
        /* Real-time Notification Toast */
        .toast-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9999;
        }
        
        .toast {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
            min-width: 300px;
            border-left: 4px solid var(--secondary-color);
        }
        
        .toast.success {
            border-left-color: var(--success-color);
        }
        
        .toast.warning {
            border-left-color: var(--warning-color);
        }
        
        .toast.error {
            border-left-color: var(--danger-color);
        }
        
        .toast-header {
            background: transparent;
            border-bottom: 1px solid #eee;
        }
        
        /* WebSocket Status Indicator */
        .websocket-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .websocket-status.connected {
            background-color: var(--success-color);
            color: white;
        }
        
        .websocket-status.disconnected {
            background-color: var(--danger-color);
            color: white;
        }
        
        .websocket-status.connecting {
            background-color: var(--warning-color);
            color: white;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.1rem;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .balance-amount {
                font-size: 2rem;
            }
            
            .user-welcome {
                font-size: 1.5rem;
            }
            
            .auth-card {
                padding: 30px 20px;
            }
            
            .admin-welcome {
                font-size: 1.5rem;
            }
            
            .stat-number {
                font-size: 1.5rem;
            }
            
            .toast-container {
                top: 80px;
                right: 10px;
                left: 10px;
            }
            
            .toast {
                min-width: unset;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Crypto Marquee -->
    <div class="crypto-marquee" id="cryptoMarquee">
        <marquee behavior="scroll" direction="left" id="marqueeContent">
            Loading cryptocurrency prices...
        </marquee>
    </div>

    <!-- WebSocket Status Indicator -->
    <div class="websocket-status disconnected" id="websocketStatus">
        <i class="fas fa-wifi me-1"></i> <span id="websocketStatusText">Disconnected</span>
    </div>

    <!-- Toast Container for Real-time Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showPage('home')">
                <i class="fas fa-rocket me-2"></i>Galaxy Digital Holdings
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('home')">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('login')">Login</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('register')">Register</a>
                    </li>
                    <li class="nav-item d-none" id="dashboardNavItem">
                        <a class="nav-link" href="#" onclick="showPage('dashboard')">Dashboard</a>
                    </li>
                    <li class="nav-item d-none" id="adminDashboardNavItem">
                        <a class="nav-link" href="#" onclick="showPage('adminDashboard')">Admin</a>
                    </li>
                    <li class="nav-item d-none" id="logoutNavItem">
                        <a class="nav-link" href="#" id="logoutNavLink">Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Home Page -->
    <div id="homePage" class="page-container active">
        <!-- Hero Section -->
        <section class="hero-section" id="home">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-6 hero-content">
                        <h1 class="hero-title">Innovative Solutions for Your Business</h1>
                        <p class="hero-subtitle">We provide cutting-edge technology solutions to help your business grow and thrive in the digital age.</p>
                        <div class="hero-buttons">
                            <button class="btn btn-primary-custom me-3" onclick="showPage('register')">Get Started</button>
                            <button class="btn btn-outline-custom">Learn More</button>
                        </div>
                    </div>
                    <div class="col-lg-6 text-center">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAwIiBoZWlnaHQ9IjQwMCIgdmlld0JveD0iMCAwIDUwMCA0MDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjUwMCIgaGVpZ2h0PSI0MDAiIGZpbGw9IiMzNDk4ZGIiLz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxjaXJjbGUgZmlsbD0iI2ZmZiIgZmlsbC1vcGFjaXR5PSIwLjEiIGN4PSIyNTAiIGN5PSIyMDAiIHI9IjE1MCIvPjxjaXJjbGUgZmlsbD0iI2ZmZiIgZmlsbC1vcGFjaXR5PSIwLjA1IiBjeD0iMjUwIiBjeT0iMjAwIiByPSIyMDAiLz48cGF0aCBkPSJNMzUwIDIwMEMzNTAgMjc2LjE0IDI4Ni4xNCAzNDAgMjEwIDM0MFM3MCAyNzYuMTQgNzAgMjAwUzEzMy44NiA2MCAyMTAgNjBzMTQwIDc2LjE0IDE0MCAxNDB6IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9IjAuMiIvPjxwYXRoIGQ9Ik0yMTAgMjUwYy0yNy42MSAwLTUwLTIyLjM5LTUwLTUwczIyLjM5LTUwIDUwLTUwIDUwIDIyLjM5IDUwIDUwLTIyLjM5IDUwLTUwIDUweiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik0yMTAgMTcwYy0xNi41NyAwLTMwLTEzLjQzLTMwLTMwczEzLjQzLTMwIDMwLTMwIDMwIDEzLjQzIDMwIDMwLTEzLjQzIDMwLTMwIDMweiIgZmlsbD0iI2U3NGMzYyIvPjwvZz48L3N2Zz4=" 
                             alt="Business Solutions" class="img-fluid">
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section" id="about">
            <div class="container">
                <div class="row text-center mb-5">
                    <div class="col-lg-8 mx-auto">
                        <h2 class="section-title">Why Choose Galaxy Digital Holdings?</h2>
                        <p class="section-subtitle">We offer a comprehensive suite of services designed to meet all your business technology needs.</p>
                    </div>
                </div>
                <div class="row g-4">
                    <div class="col-md-4">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-laptop-code"></i>
                            </div>
                            <h3 class="feature-title">Custom Software</h3>
                            <p>Tailored software solutions designed specifically for your business processes and requirements.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <h3 class="feature-title">Cloud Solutions</h3>
                            <p>Secure and scalable cloud infrastructure to power your business operations from anywhere.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="feature-card">
                            <div class="feature-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3 class="feature-title">Cybersecurity</h3>
                            <p>Comprehensive security solutions to protect your data and systems from modern threats.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 col-md-6 mb-4">
                        <h5>Galaxy Digital Holdings</h5>
                        <p>Providing innovative technology solutions since 2010. We help businesses transform and succeed in the digital era.</p>
                        <div class="social-icons mt-4">
                            <a href="#"><i class="fab fa-facebook-f"></i></a>
                            <a href="#"><i class="fab fa-twitter"></i></a>
                            <a href="#"><i class="fab fa-linkedin-in"></i></a>
                            <a href="#"><i class="fab fa-instagram"></i></a>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-6 mb-4">
                        <h5>Quick Links</h5>
                        <ul class="footer-links">
                            <li><a href="#" onclick="showPage('home')">Home</a></li>
                            <li><a href="#about">About Us</a></li>
                            <li><a href="#">Services</a></li>
                            <li><a href="#">Portfolio</a></li>
                            <li><a href="#">Contact</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4">
                        <h5>Services</h5>
                        <ul class="footer-links">
                            <li><a href="#">Web Development</a></li>
                            <li><a href="#">Mobile Apps</a></li>
                            <li><a href="#">Cloud Solutions</a></li>
                            <li><a href="#">Digital Marketing</a></li>
                            <li><a href="#">IT Consulting</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-4">
                        <h5>Contact Us</h5>
                        <ul class="footer-links">
                            <li><i class="fas fa-map-marker-alt me-2"></i> 123 Business Ave, Suite 100</li>
                            <li><i class="fas fa-phone me-2"></i> (555) 123-4567</li>
                            <li><i class="fas fa-envelope me-2"></i> info@techsolutions.com</li>
                        </ul>
                    </div>
                </div>
                <div class="copyright">
                    <p>&copy; 2023 TechSolutions Inc. All Rights Reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="page-container">
        <div class="auth-container">
            <div class="auth-card">
                <h2 class="auth-title">Login to Your Account</h2>
                <div id="loginAlert" class="alert d-none"></div>
                <form id="loginForm">
                    <div class="mb-3">
                        <label for="loginEmail" class="form-label">Email address</label>
                        <input type="email" class="form-control" id="loginEmail" required>
                    </div>
                    <div class="mb-3">
                        <label for="loginPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="loginPassword" required>
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="rememberMe">
                        <label class="form-check-label" for="rememberMe">Remember me</label>
                    </div>
                    <button type="submit" class="btn btn-primary-custom w-100 mb-3">Login</button>
                </form>
                <div class="text-center">
                    <p>Don't have an account? <a href="#" onclick="showPage('register')" class="text-decoration-none">Register here</a></p>
                    <p><a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#forgotPasswordModal">Forgot your password?</a></p>
                    <p><a href="#" class="text-decoration-none" onclick="showAdminLogin()">Admin Login</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div class="modal fade" id="adminLoginModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Admin Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="adminLoginAlert" class="alert d-none"></div>
                    <form id="adminLoginForm">
                        <div class="mb-3">
                            <label for="adminUsername" class="form-label">Admin Username</label>
                            <input type="text" class="form-control" id="adminUsername" required>
                        </div>
                        <div class="mb-3">
                            <label for="adminPassword" class="form-label">Admin Password</label>
                            <input type="password" class="form-control" id="adminPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Login as Admin</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Page -->
    <div id="registerPage" class="page-container">
        <div class="auth-container">
            <div class="auth-card">
                <h2 class="auth-title">Create an Account</h2>
                <div id="registerAlert" class="alert d-none"></div>
                <form id="registerForm">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="username" class="form-label">Username *</label>
                            <input type="text" class="form-control" id="username" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">Full Name *</label>
                            <input type="text" class="form-control" id="name" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="registerEmail" class="form-label">Email address *</label>
                        <input type="email" class="form-control" id="registerEmail" required>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="registerPassword" class="form-label">Password *</label>
                            <input type="password" class="form-control" id="registerPassword" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="confirmPassword" class="form-label">Confirm Password *</label>
                            <input type="password" class="form-control" id="confirmPassword" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="secretQuestion" class="form-label">Security Question *</label>
                        <select class="form-select" id="secretQuestion" required>
                            <option value="">Select a security question</option>
                            <option value="What was your first pet's name?">What was your first pet's name?</option>
                            <option value="What city were you born in?">What city were you born in?</option>
                            <option value="What is your mother's maiden name?">What is your mother's maiden name?</option>
                            <option value="What was the name of your first school?">What was the name of your first school?</option>
                            <option value="What is your favorite book?">What is your favorite book?</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="secretAnswer" class="form-label">Security Answer *</label>
                        <input type="text" class="form-control" id="secretAnswer" required>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="bitcoinAccount" class="form-label">Bitcoin Wallet Address (Optional)</label>
                            <input type="text" class="form-control" id="bitcoinAccount">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="tetherTRC20Account" class="form-label">Tether TRC20 Address (Optional)</label>
                            <input type="text" class="form-control" id="tetherTRC20Account">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="referralCode" class="form-label">Referral Code (Optional)</label>
                        <input type="text" class="form-control" id="referralCode">
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="agreeTerms" required>
                        <label class="form-check-label" for="agreeTerms">I agree to the Terms and Conditions *</label>
                    </div>
                    <button type="submit" class="btn btn-primary-custom w-100 mb-3">Register</button>
                </form>
                <div class="text-center">
                    <p>Already have an account? <a href="#" onclick="showPage('login')" class="text-decoration-none">Login here</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboardPage" class="page-container">
        <section class="dashboard-section">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h1 class="user-welcome">Welcome, <span id="userName">User</span>!</h1>
                        <div class="d-flex align-items-center mb-3">
                            <span class="badge bg-success me-2" id="realTimeStatus">Real-time Updates Active</span>
                            <small class="text-muted" id="lastUpdate">Last update: Just now</small>
                        </div>
                    </div>
                </div>
                
                <!-- Dashboard Tabs -->
                <div class="dashboard-tabs">
                    <button class="tab-button active" onclick="switchTab('overview')">Overview</button>
                    <button class="tab-button" onclick="switchTab('invest')">Invest</button>
                    <button class="tab-button" onclick="switchTab('transactions')">Transactions</button>
                    <button class="tab-button" onclick="switchTab('referrals')">Referrals</button>
                    <button class="tab-button" onclick="switchTab('profile')">Profile</button>
                    <button class="tab-button" onclick="switchTab('notifications')">
                        Notifications
                        <span class="notification-badge d-none" id="notificationBadge">0</span>
                    </button>
                </div>
                
                <!-- Overview Tab -->
                <div id="overviewTab" class="tab-content active">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card dashboard-card balance-card">
                                <div class="card-body text-center">
                                    <i class="fas fa-wallet fa-3x mb-3"></i>
                                    <h3>Wallet Balance</h3>
                                    <div class="balance-amount">$<span id="walletBalance">0.00</span></div>
                                    <p>Available for withdrawals</p>
                                    <small class="text-white-50" id="walletUpdateTime"></small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card dashboard-card">
                                <div class="card-body text-center">
                                    <i class="fas fa-piggy-bank fa-3x mb-3 text-primary"></i>
                                    <h3>Deposit Balance</h3>
                                    <div class="balance-amount">$<span id="depositBalance">0.00</span></div>
                                    <p>Available for investments</p>
                                    <small class="text-muted" id="depositUpdateTime"></small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card dashboard-card">
                                <div class="card-body text-center">
                                    <i class="fas fa-chart-line fa-3x mb-3 text-success"></i>
                                    <h3>Total Invested</h3>
                                    <div class="balance-amount">$<span id="totalInvested">0.00</span></div>
                                    <p>All-time investment total</p>
                                    <small class="text-muted" id="investedUpdateTime"></small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-5">
                        <div class="col-md-6">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <h4 class="card-title">Recent Transactions</h4>
                                    <div id="recentTransactions">
                                        <p class="text-muted">No recent transactions</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <h4 class="card-title">Account Actions</h4>
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary-custom mb-2" data-bs-toggle="modal" data-bs-target="#depositModal">Make Deposit</button>
                                        <button class="btn btn-outline-primary mb-2" data-bs-toggle="modal" data-bs-target="#withdrawalModal">Request Withdrawal</button>
                                        <button class="btn btn-outline-secondary mb-2" onclick="switchTab('invest')">Start Investment</button>
                                        <button class="btn btn-outline-info" id="checkApprovedDeposits">Check Approved Deposits</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Invest Tab -->
                <div id="investTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <h3>Investment Plans</h3>
                            <p class="text-muted">Choose an investment plan that suits your financial goals</p>
                        </div>
                    </div>
                    
                    <div class="row" id="investmentPlansContainer">
                        <!-- Investment plans will be loaded here -->
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <h4 class="card-title">Active Investments</h4>
                                    <div id="activeInvestments">
                                        <p class="text-muted">No active investments</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Transactions Tab -->
                <div id="transactionsTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <h3>Transaction History</h3>
                            <div class="d-flex justify-content-between align-items-center">
                                <p class="text-muted mb-0">View all your transactions</p>
                                <div>
                                    <select class="form-select form-select-sm" id="transactionFilter" onchange="loadTransactions()">
                                        <option value="all">All Transactions</option>
                                        <option value="deposit">Deposits</option>
                                        <option value="withdrawal">Withdrawals</option>
                                        <option value="investment">Investments</option>
                                        <option value="profit">Profits</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <div id="transactionHistory">
                                        <p class="text-muted">Loading transactions...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Referrals Tab -->
                <div id="referralsTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <h3>Referral Program</h3>
                            <p class="text-muted">Earn commissions by referring new users to our platform</p>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card dashboard-card">
                                <div class="card-body text-center">
                                    <i class="fas fa-users fa-3x mb-3 text-primary"></i>
                                    <h3>Total Referrals</h3>
                                    <div class="balance-amount"><span id="totalReferrals">0</span></div>
                                    <p>Users you've referred</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <h4 class="card-title">Your Referral Code</h4>
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" id="referralCodeDisplay" readonly>
                                        <button class="btn btn-primary-custom" type="button" onclick="copyReferralCode()">Copy</button>
                                    </div>
                                    <p class="small text-muted">Share this code with friends to earn referral bonuses</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <h4 class="card-title">Referral History</h4>
                                    <div id="referralList">
                                        <p class="text-muted">No referrals yet</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Profile Tab -->
                <div id="profileTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <h3>Profile Settings</h3>
                            <p class="text-muted">Manage your account information and security settings</p>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <h4 class="card-title">Personal Information</h4>
                                    <form id="profileForm">
                                        <div class="mb-3">
                                            <label for="profileName" class="form-label">Full Name</label>
                                            <input type="text" class="form-control" id="profileName">
                                        </div>
                                        <div class="mb-3">
                                            <label for="profileEmail" class="form-label">Email Address</label>
                                            <input type="email" class="form-control" id="profileEmail" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="profileBitcoin" class="form-label">Bitcoin Wallet Address</label>
                                            <input type="text" class="form-control" id="profileBitcoin">
                                        </div>
                                        <div class="mb-3">
                                            <label for="profileTether" class="form-label">Tether TRC20 Address</label>
                                            <input type="text" class="form-control" id="profileTether">
                                        </div>
                                        <button type="submit" class="btn btn-primary-custom">Update Profile</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <h4 class="card-title">Security Settings</h4>
                                    <form id="passwordForm">
                                        <div class="mb-3">
                                            <label for="currentPassword" class="form-label">Current Password</label>
                                            <input type="password" class="form-control" id="currentPassword">
                                        </div>
                                        <div class="mb-3">
                                            <label for="newPassword" class="form-label">New Password</label>
                                            <input type="password" class="form-control" id="newPassword">
                                        </div>
                                        <div class="mb-3">
                                            <label for="confirmNewPassword" class="form-label">Confirm New Password</label>
                                            <input type="password" class="form-control" id="confirmNewPassword">
                                        </div>
                                        <button type="submit" class="btn btn-primary-custom">Change Password</button>
                                    </form>
                                </div>
                            </div>
                            
                            <div class="card dashboard-card mt-4">
                                <div class="card-body">
                                    <h4 class="card-title">Security Question</h4>
                                    <form id="securityForm">
                                        <div class="mb-3">
                                            <label for="securityQuestion" class="form-label">Security Question</label>
                                            <select class="form-select" id="securityQuestion">
                                                <option value="What was your first pet's name?">What was your first pet's name?</option>
                                                <option value="What city were you born in?">What city were you born in?</option>
                                                <option value="What is your mother's maiden name?">What is your mother's maiden name?</option>
                                                <option value="What was the name of your first school?">What was the name of your first school?</option>
                                                <option value="What is your favorite book?">What is your favorite book?</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="securityAnswer" class="form-label">Security Answer</label>
                                            <input type="text" class="form-control" id="securityAnswer">
                                        </div>
                                        <button type="submit" class="btn btn-primary-custom">Update Security</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Notifications Tab -->
                <div id="notificationsTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <h3>Notifications</h3>
                                <button class="btn btn-outline-secondary btn-sm" onclick="markAllNotificationsAsRead()">Mark All as Read</button>
                            </div>
                            <p class="text-muted">Stay updated with your account activities</p>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="card dashboard-card">
                                <div class="card-body">
                                    <div id="notificationsList">
                                        <p class="text-muted">Loading notifications...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Admin Dashboard Page -->
    <div id="adminDashboardPage" class="page-container">
        <section class="admin-dashboard">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h1 class="admin-welcome">Admin Dashboard</h1>
                        <p class="lead">Manage users, transactions, and investments with real-time updates</p>
                    </div>
                </div>
                
                <!-- Admin Dashboard Tabs -->
                <div class="dashboard-tabs">
                    <button class="tab-button active" onclick="switchAdminTab('overview')">Overview</button>
                    <button class="tab-button" onclick="switchAdminTab('users')">Users</button>
                    <button class="tab-button" onclick="switchAdminTab('transactions')">Transactions</button>
                    <button class="tab-button" onclick="switchAdminTab('investments')">Investments</button>
                    <button class="tab-button" onclick="switchAdminTab('messages')">Messages</button>
                    <button class="tab-button" onclick="switchAdminTab('notifications')">
                        Notifications
                        <span class="notification-badge d-none" id="adminNotificationBadge">0</span>
                    </button>
                </div>
                
                <!-- Admin Overview Tab -->
                <div id="adminOverviewTab" class="tab-content active">
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card admin-card stat-card">
                                <div class="card-body">
                                    <i class="fas fa-users stat-icon"></i>
                                    <div class="stat-number" id="totalUsers">0</div>
                                    <div class="stat-label">Total Users</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card admin-card stat-card">
                                <div class="card-body">
                                    <i class="fas fa-money-bill-wave stat-icon"></i>
                                    <div class="stat-number">$<span id="totalDeposits">0</span></div>
                                    <div class="stat-label">Total Deposits</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card admin-card stat-card">
                                <div class="card-body">
                                    <i class="fas fa-hand-holding-usd stat-icon"></i>
                                    <div class="stat-number">$<span id="totalWithdrawals">0</span></div>
                                    <div class="stat-label">Total Withdrawals</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card admin-card stat-card">
                                <div class="card-body">
                                    <i class="fas fa-chart-line stat-icon"></i>
                                    <div class="stat-number">$<span id="totalInvestments">0</span></div>
                                    <div class="stat-label">Total Investments</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card admin-card">
                                <div class="card-body">
                                    <h4 class="card-title">Recent Registrations</h4>
                                    <div id="recentRegistrations">
                                        <p class="text-muted">Loading recent registrations...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card admin-card">
                                <div class="card-body">
                                    <h4 class="card-title">Pending Actions</h4>
                                    <div id="pendingActions">
                                        <p class="text-muted">Loading pending actions...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Users Tab -->
                <div id="adminUsersTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <h3>User Management</h3>
                                <div class="d-flex">
                                    <input type="text" class="form-control me-2" id="userSearch" placeholder="Search users...">
                                    <button class="btn btn-primary-custom" onclick="loadAdminUsers()">Search</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="card admin-card">
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table admin-table">
                                            <thead>
                                                <tr>
                                                    <th>Username</th>
                                                    <th>Email</th>
                                                    <th>Wallet Balance</th>
                                                    <th>Deposit Balance</th>
                                                    <th>Total Invested</th>
                                                    <th>Status</th>
                                                    <th>Joined</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="usersTable">
                                                <tr>
                                                    <td colspan="8" class="text-center">Loading users...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Transactions Tab -->
                <div id="adminTransactionsTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <div class="d-flex justify-content-between align-items-center">
                                <h3>Transaction Management</h3>
                                <div>
                                    <select class="form-select" id="transactionTypeFilter" onchange="loadAdminTransactions()">
                                        <option value="all">All Types</option>
                                        <option value="deposit">Deposits</option>
                                        <option value="withdrawal">Withdrawals</option>
                                        <option value="investment">Investments</option>
                                        <option value="profit">Profits</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="card admin-card">
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table admin-table">
                                            <thead>
                                                <tr>
                                                    <th>User</th>
                                                    <th>Type</th>
                                                    <th>Amount</th>
                                                    <th>Status</th>
                                                    <th>Date</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="transactionsTable">
                                                <tr>
                                                    <td colspan="6" class="text-center">Loading transactions...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Investments Tab -->
                <div id="adminInvestmentsTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <h3>Investment Management</h3>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="card admin-card">
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table admin-table">
                                            <thead>
                                                <tr>
                                                    <th>User</th>
                                                    <th>Plan</th>
                                                    <th>Amount</th>
                                                    <th>Profit Rate</th>
                                                    <th>Status</th>
                                                    <th>Start Date</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="investmentsTable">
                                                <tr>
                                                    <td colspan="7" class="text-center">Loading investments...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Messages Tab -->
                <div id="adminMessagesTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <h3>Send Message to Users</h3>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="card admin-card">
                                <div class="card-body">
                                    <form id="adminMessageForm">
                                        <div class="mb-3">
                                            <label for="messageRecipients" class="form-label">Recipients</label>
                                            <select class="form-select" id="messageRecipients" multiple>
                                                <option value="all">All Users</option>
                                            </select>
                                            <div class="form-text">Hold Ctrl/Cmd to select multiple users</div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="messageTitle" class="form-label">Title</label>
                                            <input type="text" class="form-control" id="messageTitle" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="messageContent" class="form-label">Content</label>
                                            <textarea class="form-control" id="messageContent" rows="5" required></textarea>
                                        </div>
                                        <div class="mb-3 form-check">
                                            <input type="checkbox" class="form-check-input" id="messageImportant">
                                            <label class="form-check-label" for="messageImportant">Mark as important</label>
                                        </div>
                                        <button type="submit" class="btn btn-primary-custom">Send Message</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Admin Notifications Tab -->
                <div id="adminNotificationsTab" class="tab-content">
                    <div class="row">
                        <div class="col-12 mb-4">
                            <h3>System Notifications</h3>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12">
                            <div class="card admin-card">
                                <div class="card-body">
                                    <div id="adminNotificationsList">
                                        <p class="text-muted">Loading notifications...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Forgot Password Modal -->
    <div class="modal fade" id="forgotPasswordModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Reset Password</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="forgotPasswordAlert" class="alert d-none"></div>
                    <form id="forgotPasswordForm">
                        <div class="mb-3">
                            <label for="forgotEmail" class="form-label">Email address</label>
                            <input type="email" class="form-control" id="forgotEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="securityAnswer" class="form-label">Security Answer</label>
                            <input type="text" class="form-control" id="securityAnswer" required>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Reset Password</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div class="modal fade" id="depositModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Make a Deposit</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="depositAlert" class="alert d-none"></div>
                    <form id="depositForm">
                        <div class="mb-3">
                            <label for="depositAmount" class="form-label">Amount</label>
                            <input type="number" class="form-control" id="depositAmount" min="1" required>
                        </div>
                        <div class="mb-3">
                            <label for="depositMethod" class="form-label">Payment Method</label>
                            <select class="form-select" id="depositMethod" required>
                                <option value="">Select payment method</option>
                                <option value="bitcoin">Bitcoin</option>
                                <option value="tether">Tether (TRC20)</option>
                                <option value="bank">Bank Transfer</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="depositProof" class="form-label">Proof of Payment</label>
                            <input type="file" class="form-control" id="depositProof" accept="image/*,.pdf" required>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Submit Deposit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Withdrawal Modal -->
    <div class="modal fade" id="withdrawalModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Request Withdrawal</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="withdrawalAlert" class="alert d-none"></div>
                    <form id="withdrawalForm">
                        <div class="mb-3">
                            <label for="withdrawalAmount" class="form-label">Amount</label>
                            <input type="number" class="form-control" id="withdrawalAmount" min="1" required>
                        </div>
                        <div class="mb-3">
                            <label for="withdrawalMethod" class="form-label">Withdrawal Method</label>
                            <select class="form-select" id="withdrawalMethod" required>
                                <option value="">Select withdrawal method</option>
                                <option value="bitcoin">Bitcoin</option>
                                <option value="tether">Tether (TRC20)</option>
                                <option value="bank">Bank Transfer</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="withdrawalWallet" class="form-label">Wallet Address</label>
                            <input type="text" class="form-control" id="withdrawalWallet" required>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Submit Withdrawal Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Investment Modal -->
    <div class="modal fade" id="investmentModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Start Investment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="investmentAlert" class="alert d-none"></div>
                    <form id="investmentForm">
                        <div class="mb-3">
                            <label for="investmentPlan" class="form-label">Investment Plan</label>
                            <select class="form-select" id="investmentPlan" required>
                                <option value="">Select investment plan</option>
                                <option value="1">Basic Plan (5% profit)</option>
                                <option value="2">Premium Plan (8% profit)</option>
                                <option value="3">VIP Plan (12% profit)</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="investmentAmount" class="form-label">Investment Amount</label>
                            <input type="number" class="form-control" id="investmentAmount" min="1" required>
                        </div>
                        <div class="mb-3">
                            <div class="alert alert-info">
                                <small>Available deposit balance: $<span id="availableBalance">0.00</span></small>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Submit Investment Request</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- User Balance Update Modal (Admin) -->
    <div class="modal fade" id="userBalanceModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Update User Balance</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="userBalanceAlert" class="alert d-none"></div>
                    <form id="userBalanceForm">
                        <input type="hidden" id="balanceUserId">
                        <div class="mb-3">
                            <label for="walletBalanceInput" class="form-label">Wallet Balance</label>
                            <input type="number" class="form-control" id="walletBalanceInput" min="0" step="0.01" required>
                        </div>
                        <div class="mb-3">
                            <label for="depositBalanceInput" class="form-label">Deposit Balance</label>
                            <input type="number" class="form-control" id="depositBalanceInput" min="0" step="0.01" required>
                        </div>
                        <div class="mb-3">
                            <label for="totalInvestedInput" class="form-label">Total Invested</label>
                            <input type="number" class="form-control" id="totalInvestedInput" min="0" step="0.01" required>
                        </div>
                        <div class="mb-3">
                            <label for="balanceNote" class="form-label">Admin Note</label>
                            <textarea class="form-control" id="balanceNote" rows="3" placeholder="Reason for balance update"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Update Balances</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Profit Modal (Admin) -->
    <div class="modal fade" id="addProfitModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Profit to User</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="addProfitAlert" class="alert d-none"></div>
                    <form id="addProfitForm">
                        <input type="hidden" id="profitUserId">
                        <div class="mb-3">
                            <label for="profitAmount" class="form-label">Profit Amount</label>
                            <input type="number" class="form-control" id="profitAmount" min="0.01" step="0.01" required>
                        </div>
                        <div class="mb-3">
                            <label for="profitNote" class="form-label">Profit Note</label>
                            <textarea class="form-control" id="profitNote" rows="3" placeholder="Description of profit" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary-custom w-100">Add Profit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script>
        // API Base URL - Update this to match your backend URL
        const API_BASE_URL = 'http://localhost:4000/api';
        
        // Hardcoded Admin Credentials
        const ADMIN_CREDENTIALS = {
            username: 'admin',
            password: 'admin123'
        };
        
        // State management
        let currentUser = null;
        let authToken = localStorage.getItem('authToken');
        let isAdmin = localStorage.getItem('isAdmin') === 'true';
        let investmentPlans = [];
        let cryptoPrices = {};
        let webSocket = null;
        let webSocketReconnectAttempts = 0;
        const MAX_RECONNECT_ATTEMPTS = 5;

        // DOM Elements
        const homePage = document.getElementById('homePage');
        const loginPage = document.getElementById('loginPage');
        const registerPage = document.getElementById('registerPage');
        const dashboardPage = document.getElementById('dashboardPage');
        const adminDashboardPage = document.getElementById('adminDashboardPage');
        const dashboardNavItem = document.getElementById('dashboardNavItem');
        const adminDashboardNavItem = document.getElementById('adminDashboardNavItem');
        const logoutNavItem = document.getElementById('logoutNavItem');
        const logoutNavLink = document.getElementById('logoutNavLink');
        const websocketStatus = document.getElementById('websocketStatus');
        const websocketStatusText = document.getElementById('websocketStatusText');
        const toastContainer = document.getElementById('toastContainer');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthenticationStatus();
            setupEventListeners();
            loadInvestmentPlans();
            loadCryptoPrices();
            setInterval(loadCryptoPrices, 60000); // Update crypto prices every minute
            
            // Initialize WebSocket connection if user is authenticated
            if (authToken && !isAdmin) {
                initializeWebSocket();
            }
        });

        // ================== WEBSOCKET MANAGEMENT ==================

        function initializeWebSocket() {
            if (webSocket && webSocket.readyState === WebSocket.OPEN) {
                return; // WebSocket already connected
            }

            updateWebSocketStatus('connecting', 'Connecting...');
            
            try {
                // Use wss:// for secure connections if the page is loaded over HTTPS
                const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                const wsUrl = `${protocol}//${window.location.host}/ws`;
                
                webSocket = new WebSocket(wsUrl);
                
                webSocket.onopen = function() {
                    console.log('WebSocket connected successfully');
                    updateWebSocketStatus('connected', 'Connected');
                    webSocketReconnectAttempts = 0;
                    
                    // Authenticate with the server
                    webSocket.send(JSON.stringify({
                        type: 'AUTH',
                        token: authToken
                    }));
                };
                
                webSocket.onmessage = function(event) {
                    try {
                        const data = JSON.parse(event.data);
                        console.log('WebSocket message received:', data);
                        handleWebSocketMessage(data);
                    } catch (error) {
                        console.error('Error parsing WebSocket message:', error);
                    }
                };
                
                webSocket.onclose = function(event) {
                    console.log('WebSocket disconnected:', event.code, event.reason);
                    updateWebSocketStatus('disconnected', 'Disconnected');
                    
                    // Attempt to reconnect if this wasn't a normal closure
                    if (event.code !== 1000 && webSocketReconnectAttempts < MAX_RECONNECT_ATTEMPTS) {
                        webSocketReconnectAttempts++;
                        const delay = Math.min(1000 * Math.pow(2, webSocketReconnectAttempts), 30000); // Exponential backoff
                        console.log(`Attempting to reconnect in ${delay}ms (attempt ${webSocketReconnectAttempts})`);
                        
                        setTimeout(() => {
                            if (authToken && !isAdmin) {
                                initializeWebSocket();
                            }
                        }, delay);
                    }
                };
                
                webSocket.onerror = function(error) {
                    console.error('WebSocket error:', error);
                    updateWebSocketStatus('disconnected', 'Connection Error');
                };
                
            } catch (error) {
                console.error('Error initializing WebSocket:', error);
                updateWebSocketStatus('disconnected', 'Connection Failed');
            }
        }

        function updateWebSocketStatus(status, text) {
            websocketStatus.className = `websocket-status ${status}`;
            websocketStatusText.textContent = text;
        }

        function handleWebSocketMessage(data) {
            switch (data.type) {
                case 'CONNECTED':
                    showToast('success', 'Real-time updates connected');
                    document.getElementById('realTimeStatus').className = 'badge bg-success me-2';
                    document.getElementById('realTimeStatus').textContent = 'Real-time Updates Active';
                    break;
                    
                case 'BALANCE_UPDATE':
                    updateUserBalances(data);
                    showToast('success', data.message || 'Your balances have been updated');
                    updateLastUpdateTime();
                    break;
                    
                case 'DEPOSIT_APPROVED':
                    updateUserBalances(data);
                    showToast('success', data.message || 'Deposit approved successfully');
                    loadTransactions();
                    updateLastUpdateTime();
                    break;
                    
                case 'WITHDRAWAL_APPROVED':
                    updateUserBalances(data);
                    showToast('success', data.message || 'Withdrawal approved successfully');
                    loadTransactions();
                    updateLastUpdateTime();
                    break;
                    
                case 'WITHDRAWAL_REJECTED':
                    updateUserBalances(data);
                    showToast('warning', data.message || 'Withdrawal request rejected');
                    loadTransactions();
                    updateLastUpdateTime();
                    break;
                    
                case 'INVESTMENT_APPROVED':
                    updateUserBalances(data);
                    showToast('success', data.message || 'Investment approved successfully');
                    loadActiveInvestments();
                    updateLastUpdateTime();
                    break;
                    
                case 'PROFIT_ADDED':
                    updateUserBalances(data);
                    showToast('success', data.message || 'Profit added to your account');
                    loadTransactions();
                    updateLastUpdateTime();
                    break;
                    
                case 'NEW_NOTIFICATION':
                    showToast('info', data.message || 'You have a new notification');
                    loadUserNotifications();
                    updateNotificationBadge();
                    break;
                    
                case 'NEW_MESSAGE':
                    showToast('info', 'You have a new message from admin');
                    break;
                    
                case 'ERROR':
                    showToast('error', data.message || 'An error occurred');
                    break;
                    
                default:
                    console.log('Unhandled WebSocket message type:', data.type);
            }
        }

        function updateLastUpdateTime() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = `Last update: ${now.toLocaleTimeString()}`;
        }

        function updateUserBalances(data) {
            if (data.walletBalance !== undefined) {
                document.getElementById('walletBalance').textContent = data.walletBalance.toFixed(2);
                document.getElementById('walletUpdateTime').textContent = `Updated: ${new Date().toLocaleTimeString()}`;
            }
            if (data.depositBalance !== undefined) {
                document.getElementById('depositBalance').textContent = data.depositBalance.toFixed(2);
                document.getElementById('depositUpdateTime').textContent = `Updated: ${new Date().toLocaleTimeString()}`;
            }
            if (data.totalInvested !== undefined) {
                document.getElementById('totalInvested').textContent = data.totalInvested.toFixed(2);
                document.getElementById('investedUpdateTime').textContent = `Updated: ${new Date().toLocaleTimeString()}`;
            }
            if (data.availableBalance !== undefined) {
                document.getElementById('availableBalance').textContent = data.availableBalance.toFixed(2);
            }
            
            // Update current user object if it exists
            if (currentUser) {
                if (data.walletBalance !== undefined) currentUser.walletBalance = data.walletBalance;
                if (data.depositBalance !== undefined) currentUser.depositBalance = data.depositBalance;
                if (data.totalInvested !== undefined) currentUser.totalInvested = data.totalInvested;
            }
        }

        // ================== TOAST NOTIFICATION SYSTEM ==================

        function showToast(type, message, duration = 5000) {
            const toast = document.createElement('div');
            toast.className = `toast ${type} show`;
            toast.innerHTML = `
                <div class="toast-header">
                    <strong class="me-auto">${type.charAt(0).toUpperCase() + type.slice(1)}</strong>
                    <small>${new Date().toLocaleTimeString()}</small>
                    <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
                </div>
                <div class="toast-body">
                    ${message}
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Add click handler for close button
            toast.querySelector('.btn-close').addEventListener('click', () => {
                toast.remove();
            });
            
            // Auto remove after duration
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, duration);
        }

        // ================== PAGE MANAGEMENT ==================

        // Show specific page and hide others
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page-container').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show the requested page
            document.getElementById(pageId + 'Page').classList.add('active');
            
            // Update navigation based on authentication
            updateNavigation();
            
            // Load data for dashboard
            if (pageId === 'dashboard' && authToken) {
                updateDashboardData();
                loadTransactions();
                loadReferrals();
                loadActiveInvestments();
                loadUserNotifications();
                
                // Initialize WebSocket if not already connected
                if (!webSocket || webSocket.readyState !== WebSocket.OPEN) {
                    initializeWebSocket();
                }
            } else if (pageId === 'adminDashboard' && isAdmin) {
                loadAdminDashboardData();
                loadAdminUsers();
                loadAdminTransactions();
                loadAdminInvestments();
                loadAdminNotifications();
            }
        }

        // Switch between dashboard tabs
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show the selected tab content
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Add active class to the clicked button
            event.target.classList.add('active');
            
            // Load specific data for the tab
            if (tabName === 'transactions') {
                loadTransactions();
            } else if (tabName === 'referrals') {
                loadReferrals();
            } else if (tabName === 'invest') {
                loadActiveInvestments();
            } else if (tabName === 'profile') {
                loadProfileData();
            } else if (tabName === 'notifications') {
                loadUserNotifications();
            }
        }

        // Switch between admin dashboard tabs
        function switchAdminTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show the selected tab content
            document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1) + 'Tab').classList.add('active');
            
            // Add active class to the clicked button
            event.target.classList.add('active');
            
            // Load specific data for the tab
            if (tabName === 'users') {
                loadAdminUsers();
            } else if (tabName === 'transactions') {
                loadAdminTransactions();
            } else if (tabName === 'investments') {
                loadAdminInvestments();
            } else if (tabName === 'notifications') {
                loadAdminNotifications();
            }
        }

        // Check if user is authenticated
        function checkAuthenticationStatus() {
            if (authToken && isAdmin) {
                showPage('adminDashboard');
                loadAdminDashboardData();
            } else if (authToken) {
                fetchUserData();
            } else {
                showPage('home');
            }
        }

        // Fetch user data with the auth token
        async function fetchUserData() {
            try {
                const response = await fetch(`${API_BASE_URL}/me`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        currentUser = result.data.user;
                        showPage('dashboard');
                        updateDashboardData();
                    } else {
                        // Token is invalid, clear it
                        localStorage.removeItem('authToken');
                        authToken = null;
                        showPage('home');
                    }
                } else {
                    // Token is invalid, clear it
                    localStorage.removeItem('authToken');
                    authToken = null;
                    showPage('home');
                }
            } catch (error) {
                console.error('Error fetching user data:', error);
                showPage('home');
            }
        }

        // Update navigation based on authentication status
        function updateNavigation() {
            if (authToken && currentUser) {
                dashboardNavItem.classList.remove('d-none');
                logoutNavItem.classList.remove('d-none');
                adminDashboardNavItem.classList.add('d-none');
            } else if (isAdmin) {
                dashboardNavItem.classList.add('d-none');
                adminDashboardNavItem.classList.remove('d-none');
                logoutNavItem.classList.remove('d-none');
            } else {
                dashboardNavItem.classList.add('d-none');
                adminDashboardNavItem.classList.add('d-none');
                logoutNavItem.classList.add('d-none');
            }
        }

        // Update dashboard with user data
        function updateDashboardData() {
            if (currentUser) {
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('walletBalance').textContent = currentUser.walletBalance ? currentUser.walletBalance.toFixed(2) : '0.00';
                document.getElementById('depositBalance').textContent = currentUser.depositBalance ? currentUser.depositBalance.toFixed(2) : '0.00';
                document.getElementById('totalInvested').textContent = currentUser.totalInvested ? currentUser.totalInvested.toFixed(2) : '0.00';
                document.getElementById('availableBalance').textContent = currentUser.depositBalance ? currentUser.depositBalance.toFixed(2) : '0.00';
            }
        }

        // ================== ADMIN FUNCTIONALITIES ==================

        // Load admin dashboard data
        async function loadAdminDashboardData() {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/dashboard-stats`, {
                    headers: {
                        'Admin-Username': ADMIN_CREDENTIALS.username,
                        'Admin-Password': ADMIN_CREDENTIALS.password
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        document.getElementById('totalUsers').textContent = result.data.totalUsers;
                        document.getElementById('totalDeposits').textContent = result.data.totalDeposits.toFixed(2);
                        document.getElementById('totalWithdrawals').textContent = result.data.totalWithdrawals.toFixed(2);
                        document.getElementById('totalInvestments').textContent = result.data.totalInvestments.toFixed(2);
                        
                        // Display recent registrations
                        const recentRegistrations = document.getElementById('recentRegistrations');
                        if (result.data.recentRegistrations && result.data.recentRegistrations.length > 0) {
                            let html = '';
                            result.data.recentRegistrations.forEach(user => {
                                const date = new Date(user.createdAt).toLocaleDateString();
                                html += `
                                    <div class="transaction-item">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <h6 class="mb-1">${user.username}</h6>
                                                <small class="text-muted">${user.email}  ${date}</small>
                                            </div>
                                            <div class="text-end">
                                                <small class="text-muted">${user.location ? user.location.country || 'Unknown' : 'Unknown'}</small>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            });
                            recentRegistrations.innerHTML = html;
                        } else {
                            recentRegistrations.innerHTML = '<p class="text-muted">No recent registrations</p>';
                        }
                        
                        // Display pending actions
                        const pendingActions = document.getElementById('pendingActions');
                        pendingActions.innerHTML = `
                            <div class="d-flex justify-content-between mb-3">
                                <span>Pending Deposits:</span>
                                <span class="badge bg-warning">${result.data.pendingTransactions}</span>
                            </div>
                            <div class="d-grid gap-2">
                                <button class="btn btn-primary-custom btn-sm" onclick="switchAdminTab('transactions')">Manage Transactions</button>
                            </div>
                        `;
                    }
                }
            } catch (error) {
                console.error('Error loading admin dashboard data:', error);
            }
        }

        // Load admin users
        async function loadAdminUsers() {
            try {
                const searchTerm = document.getElementById('userSearch').value;
                const url = searchTerm ? 
                    `${API_BASE_URL}/admin/users?search=${encodeURIComponent(searchTerm)}` : 
                    `${API_BASE_URL}/admin/users`;
                
                const response = await fetch(url, {
                    headers: {
                        'Admin-Username': ADMIN_CREDENTIALS.username,
                        'Admin-Password': ADMIN_CREDENTIALS.password
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        const usersTable = document.getElementById('usersTable');
                        if (result.data.users && result.data.users.length > 0) {
                            let html = '';
                            result.data.users.forEach(user => {
                                const date = new Date(user.createdAt).toLocaleDateString();
                                const statusBadge = user.isBlocked ? 
                                    '<span class="badge bg-danger">Blocked</span>' : 
                                    '<span class="badge bg-success">Active</span>';
                                
                                html += `
                                    <tr>
                                        <td>${user.username}</td>
                                        <td>${user.email}</td>
                                        <td>$${user.walletBalance ? user.walletBalance.toFixed(2) : '0.00'}</td>
                                        <td>$${user.depositBalance ? user.depositBalance.toFixed(2) : '0.00'}</td>
                                        <td>$${user.totalInvested ? user.totalInvested.toFixed(2) : '0.00'}</td>
                                        <td>${statusBadge}</td>
                                        <td>${date}</td>
                                        <td class="action-buttons">
                                            <button class="btn btn-primary btn-sm" onclick="viewUserDetails('${user._id}')">View</button>
                                            <button class="btn btn-warning btn-sm" onclick="editUserBalance('${user._id}')">Balance</button>
                                            <button class="btn btn-info btn-sm" onclick="addProfitToUser('${user._id}')">Add Profit</button>
                                            ${user.isBlocked ? 
                                                `<button class="btn btn-success btn-sm" onclick="toggleUserBlock('${user._id}', false)">Unblock</button>` : 
                                                `<button class="btn btn-danger btn-sm" onclick="toggleUserBlock('${user._id}', true)">Block</button>`
                                            }
                                        </td>
                                    </tr>
                                `;
                            });
                            usersTable.innerHTML = html;
                        } else {
                            usersTable.innerHTML = '<tr><td colspan="8" class="text-center">No users found</td></tr>';
                        }
                    }
                }
            } catch (error) {
                console.error('Error loading admin users:', error);
            }
        }

        // Edit user balance (Admin)
        function editUserBalance(userId) {
            // In a real implementation, you would fetch the user's current balances first
            document.getElementById('balanceUserId').value = userId;
            document.getElementById('walletBalanceInput').value = '';
            document.getElementById('depositBalanceInput').value = '';
            document.getElementById('totalInvestedInput').value = '';
            document.getElementById('balanceNote').value = '';
            
            const modal = new bootstrap.Modal(document.getElementById('userBalanceModal'));
            modal.show();
        }

        // Add profit to user (Admin)
        function addProfitToUser(userId) {
            document.getElementById('profitUserId').value = userId;
            document.getElementById('profitAmount').value = '';
            document.getElementById('profitNote').value = '';
            
            const modal = new bootstrap.Modal(document.getElementById('addProfitModal'));
            modal.show();
        }

        // Update user balances (Admin)
        async function updateUserBalancesAdmin(userId, walletBalance, depositBalance, totalInvested, note = '') {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/user/${userId}/balance`, {
                    method: 'PUT',
                    headers: {
                        'Admin-Username': ADMIN_CREDENTIALS.username,
                        'Admin-Password': ADMIN_CREDENTIALS.password,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ walletBalance, depositBalance, totalInvested, note })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showToast('success', 'User balances updated successfully');
                    loadAdminUsers(); // Refresh user list
                    return result.data;
                } else {
                    showToast('error', result.message);
                    return null;
                }
            } catch (error) {
                console.error('Error updating balances:', error);
                showToast('error', 'Failed to update balances');
                return null;
            }
        }

        // Add profit to user (Admin)
        async function addUserProfit(userId, amount, note = '') {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/user/${userId}/profit`, {
                    method: 'POST',
                    headers: {
                        'Admin-Username': ADMIN_CREDENTIALS.username,
                        'Admin-Password': ADMIN_CREDENTIALS.password,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ amount, note })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showToast('success', `Profit of $${amount} added to user successfully`);
                    loadAdminUsers(); // Refresh user list
                    return result.data;
                } else {
                    showToast('error', result.message);
                    return null;
                }
            } catch (error) {
                console.error('Error adding profit:', error);
                showToast('error', 'Failed to add profit');
                return null;
            }
        }

        // Load admin transactions
        async function loadAdminTransactions() {
            try {
                const filter = document.getElementById('transactionTypeFilter').value;
                const url = filter === 'all' ? 
                    `${API_BASE_URL}/admin/transactions` : 
                    `${API_BASE_URL}/admin/transactions?type=${filter}`;
                
                const response = await fetch(url, {
                    headers: {
                        'Admin-Username': ADMIN_CREDENTIALS.username,
                        'Admin-Password': ADMIN_CREDENTIALS.password
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        const transactionsTable = document.getElementById('transactionsTable');
                        if (result.data.transactions && result.data.transactions.length > 0) {
                            let html = '';
                            result.data.transactions.forEach(transaction => {
                                const date = new Date(transaction.createdAt).toLocaleDateString();
                                const statusClass = `status-${transaction.status}`;
                                const statusBadge = `<span class="transaction-status ${statusClass}">${transaction.status}</span>`;
                                
                                html += `
                                    <tr>
                                        <td>${transaction.user ? transaction.user.username : 'N/A'}</td>
                                        <td>${transaction.type}</td>
                                        <td>$${transaction.amount.toFixed(2)}</td>
                                        <td>${statusBadge}</td>
                                        <td>${date}</td>
                                        <td class="action-buttons">
                                            ${transaction.status === 'pending' ? `
                                                ${transaction.type === 'deposit' ? `
                                                    <button class="btn btn-success btn-sm" onclick="approveTransaction('${transaction._id}', 'deposit')">Approve</button>
                                                    <button class="btn btn-danger btn-sm" onclick="rejectTransaction('${transaction._id}', 'deposit')">Reject</button>
                                                ` : ''}
                                                ${transaction.type === 'withdrawal' ? `
                                                    <button class="btn btn-success btn-sm" onclick="approveTransaction('${transaction._id}', 'withdrawal')">Approve</button>
                                                    <button class="btn btn-danger btn-sm" onclick="rejectTransaction('${transaction._id}', 'withdrawal')">Reject</button>
                                                ` : ''}
                                                ${transaction.type === 'investment' ? `
                                                    <button class="btn btn-success btn-sm" onclick="approveTransaction('${transaction._id}', 'investment')">Approve</button>
                                                    <button class="btn btn-danger btn-sm" onclick="rejectTransaction('${transaction._id}', 'investment')">Reject</button>
                                                ` : ''}
                                            ` : ''}
                                            <button class="btn btn-info btn-sm" onclick="viewTransactionDetails('${transaction._id}')">Details</button>
                                        </td>
                                    </tr>
                                `;
                            });
                            transactionsTable.innerHTML = html;
                        } else {
                            transactionsTable.innerHTML = '<tr><td colspan="6" class="text-center">No transactions found</td></tr>';
                        }
                    }
                }
            } catch (error) {
                console.error('Error loading admin transactions:', error);
            }
        }

        // Load admin investments
        async function loadAdminInvestments() {
            try {
                // This would typically come from your backend API
                // For now, we'll display a placeholder
                const investmentsTable = document.getElementById('investmentsTable');
                investmentsTable.innerHTML = `
                    <tr>
                        <td colspan="7" class="text-center">
                            Investment management functionality would be implemented here with real data from the backend.
                            This would include approving/rejecting investments, viewing investment details, etc.
                        </td>
                    </tr>
                `;
            } catch (error) {
                console.error('Error loading admin investments:', error);
            }
        }

        // Load admin notifications
        async function loadAdminNotifications() {
            try {
                // This would typically come from your backend API
                // For now, we'll display a placeholder
                const adminNotificationsList = document.getElementById('adminNotificationsList');
                adminNotificationsList.innerHTML = `
                    <div class="notification-item">
                        <h6>System Update</h6>
                        <p>Admin dashboard has been successfully implemented with all required functionalities.</p>
                        <small class="text-muted">Just now</small>
                    </div>
                    <div class="notification-item">
                        <h6>New User Registration</h6>
                        <p>User "john_doe" has registered on the platform.</p>
                        <small class="text-muted">2 hours ago</small>
                    </div>
                    <div class="notification-item important">
                        <h6>Pending Deposits</h6>
                        <p>There are 3 pending deposits that require approval.</p>
                        <small class="text-muted">5 hours ago</small>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading admin notifications:', error);
            }
        }

        // ================== USER FUNCTIONALITIES ==================

        // Load user notifications
        async function loadUserNotifications() {
            try {
                if (!authToken) return;
                
                const response = await fetch(`${API_BASE_URL}/user/notifications`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        const notificationsList = document.getElementById('notificationsList');
                        const notificationBadge = document.getElementById('notificationBadge');
                        
                        if (result.data.notifications && result.data.notifications.length > 0) {
                            let html = '';
                            result.data.notifications.forEach(notif => {
                                const date = new Date(notif.createdAt).toLocaleString();
                                const unreadClass = notif.isRead ? '' : 'unread';
                                const importantClass = notif.type === 'important' ? 'important' : '';
                                
                                html += `
                                    <div class="notification-item ${unreadClass} ${importantClass}">
                                        <h6>${notif.title}</h6>
                                        <p>${notif.content}</p>
                                        <small class="text-muted">${date}</small>
                                        ${!notif.isRead ? `
                                            <button class="btn btn-sm btn-outline-primary mt-2" onclick="markNotificationAsRead('${notif._id}')">Mark as Read</button>
                                        ` : ''}
                                    </div>
                                `;
                            });
                            notificationsList.innerHTML = html;
                            
                            // Update notification badge
                            if (result.data.unreadCount > 0) {
                                notificationBadge.textContent = result.data.unreadCount;
                                notificationBadge.classList.remove('d-none');
                            } else {
                                notificationBadge.classList.add('d-none');
                            }
                        } else {
                            notificationsList.innerHTML = '<p class="text-muted">No notifications</p>';
                            notificationBadge.classList.add('d-none');
                        }
                    }
                }
            } catch (error) {
                console.error('Error loading user notifications:', error);
            }
        }

        // Mark notification as read
        async function markNotificationAsRead(notificationId) {
            try {
                const response = await fetch(`${API_BASE_URL}/user/notifications/${notificationId}/read`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    loadUserNotifications();
                }
            } catch (error) {
                console.error('Error marking notification as read:', error);
            }
        }

        // Mark all notifications as read
        async function markAllNotificationsAsRead() {
            try {
                const response = await fetch(`${API_BASE_URL}/user/notifications/read-all`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    loadUserNotifications();
                }
            } catch (error) {
                console.error('Error marking all notifications as read:', error);
            }
        }

        function updateNotificationBadge() {
            // This would update the notification badge count
            // Implementation depends on your notification system
        }

        // Load investment plans
        async function loadInvestmentPlans() {
            try {
                const response = await fetch(`${API_BASE_URL}/investment-plans`);
                const result = await response.json();
                
                if (result.success) {
                    investmentPlans = result.data;
                    displayInvestmentPlans();
                }
            } catch (error) {
                console.error('Error loading investment plans:', error);
            }
        }

        // Load cryptocurrency prices
        async function loadCryptoPrices() {
            try {
                // Using CoinGecko API to get cryptocurrency prices
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,ripple,litecoin,cardano,polkadot,binancecoin,dogecoin,solana,tron&vs_currencies=usd&include_24hr_change=true');
                const data = await response.json();
                
                cryptoPrices = data;
                updateCryptoMarquee();
            } catch (error) {
                console.error('Error loading crypto prices:', error);
                // Fallback to static data if API fails
                cryptoPrices = {
                    bitcoin: { usd: 45000, usd_24h_change: 2.5 },
                    ethereum: { usd: 3000, usd_24h_change: 1.8 },
                    ripple: { usd: 0.75, usd_24h_change: -0.5 },
                    litecoin: { usd: 150, usd_24h_change: 0.3 },
                    cardano: { usd: 1.2, usd_24h_change: 1.2 },
                    polkadot: { usd: 25, usd_24h_change: -1.5 },
                    binancecoin: { usd: 400, usd_24h_change: 3.2 },
                    dogecoin: { usd: 0.15, usd_24h_change: 5.7 },
                    solana: { usd: 100, usd_24h_change: 4.1 },
                    tron: { usd: 0.08, usd_24h_change: -0.2 }
                };
                updateCryptoMarquee();
            }
        }

        // Update crypto marquee with current prices
        function updateCryptoMarquee() {
            const marqueeContent = document.getElementById('marqueeContent');
            let html = '';
            
            for (const [coin, data] of Object.entries(cryptoPrices)) {
                const symbol = coin.toUpperCase();
                const price = data.usd.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                const change = data.usd_24h_change;
                const changeClass = change >= 0 ? 'up' : 'down';
                const changeSymbol = change >= 0 ? '' : '';
                
                html += `<span class="crypto-item">
                    <span class="crypto-symbol">${symbol}:</span>
                    <span class="crypto-price ${changeClass}">${price} ${changeSymbol} ${Math.abs(change).toFixed(2)}%</span>
                </span>`;
            }
            
            marqueeContent.innerHTML = html;
        }

        // Display investment plans
        function displayInvestmentPlans() {
            const container = document.getElementById('investmentPlansContainer');
            container.innerHTML = '';
            
            investmentPlans.forEach(plan => {
                const planCard = document.createElement('div');
                planCard.className = 'col-md-4';
                planCard.innerHTML = `
                    <div class="card plan-card ${plan.name.toLowerCase().includes('basic') ? 'basic' : plan.name.toLowerCase().includes('premium') ? 'premium' : 'vip'}">
                        <div class="plan-header">
                            <h4>${plan.name}</h4>
                            <h3 class="text-primary">${plan.profitRate}% Profit</h3>
                            <p class="text-muted">${plan.duration}</p>
                        </div>
                        <div class="plan-body">
                            <p>${plan.description}</p>
                            <ul class="plan-features">
                                <li><i class="fas fa-check text-success me-2"></i> Min: $${plan.minDeposit}</li>
                                <li><i class="fas fa-check text-success me-2"></i> Max: $${plan.maxDeposit}</li>
                                <li><i class="fas fa-check text-success me-2"></i> ${plan.profitRate}% Return</li>
                                <li><i class="fas fa-check text-success me-2"></i> Secure Investment</li>
                            </ul>
                            <div class="mt-3">
                                <h6>Wallet Address for Payment:</h6>
                                <div class="wallet-address mb-2" onclick="copyWalletAddress('${plan.name}')">
                                    ${getWalletAddress(plan.name)}
                                </div>
                                <small class="text-muted">Click to copy wallet address</small>
                            </div>
                            <button class="btn btn-primary-custom w-100 mt-3" onclick="openInvestmentModal('${plan._id}')">
                                Invest Now
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(planCard);
            });
        }

        // Get wallet address based on plan
        function getWalletAddress(planName) {
            // These would typically come from your backend
            const addresses = {
                'Basic Plan': '1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa',
                'Premium Plan': '3J98t1WpEZ73CNmQviecrnyiWrnqRhWNLy',
                'VIP Plan': 'bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh'
            };
            
            return addresses[planName] || 'Wallet address not available';
        }

        // Copy wallet address to clipboard
        function copyWalletAddress(planName) {
            const address = getWalletAddress(planName);
            navigator.clipboard.writeText(address).then(() => {
                // Visual feedback
                const walletElement = event.target;
                walletElement.classList.add('copied');
                walletElement.innerHTML = `<i class="fas fa-check me-2"></i>Copied!`;
                
                setTimeout(() => {
                    walletElement.classList.remove('copied');
                    walletElement.textContent = address;
                }, 2000);
            });
        }

        // Copy referral code to clipboard
        function copyReferralCode() {
            const referralCode = document.getElementById('referralCodeDisplay').value;
            navigator.clipboard.writeText(referralCode).then(() => {
                // Visual feedback
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                button.classList.add('btn-success');
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('btn-success');
                }, 2000);
            });
        }

        // Open investment modal with selected plan
        function openInvestmentModal(planId) {
            const plan = investmentPlans.find(p => p._id === planId);
            if (plan) {
                document.getElementById('investmentPlan').value = planId;
                document.getElementById('investmentAmount').setAttribute('min', plan.minDeposit);
                document.getElementById('investmentAmount').setAttribute('max', plan.maxDeposit);
                document.getElementById('investmentAmount').value = plan.minDeposit;
                
                const modal = new bootstrap.Modal(document.getElementById('investmentModal'));
                modal.show();
            }
        }

        // Load transactions
        async function loadTransactions() {
            try {
                const filter = document.getElementById('transactionFilter').value;
                const url = filter === 'all' 
                    ? `${API_BASE_URL}/user/transactions` 
                    : `${API_BASE_URL}/user/transactions?type=${filter}`;
                
                const response = await fetch(url, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    displayTransactions(result.data);
                } else {
                    document.getElementById('transactionHistory').innerHTML = '<p class="text-muted">Error loading transactions</p>';
                }
            } catch (error) {
                console.error('Error loading transactions:', error);
                document.getElementById('transactionHistory').innerHTML = '<p class="text-muted">Error loading transactions</p>';
            }
        }

        // Display transactions
        function displayTransactions(transactions) {
            const container = document.getElementById('transactionHistory');
            
            if (!transactions || transactions.length === 0) {
                container.innerHTML = '<p class="text-muted">No transactions found</p>';
                return;
            }
            
            let html = '';
            transactions.forEach(transaction => {
                const date = new Date(transaction.createdAt).toLocaleDateString();
                const statusClass = `status-${transaction.status}`;
                
                html += `
                    <div class="transaction-item">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">${transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1)}</h6>
                                <small class="text-muted">${date}  ${transaction.investmentPlan || ''}</small>
                            </div>
                            <div class="text-end">
                                <div class="fw-bold">$${transaction.amount.toFixed(2)}</div>
                                <span class="transaction-status ${statusClass}">${transaction.status}</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Load referrals
        async function loadReferrals() {
            try {
                const response = await fetch(`${API_BASE_URL}/user/referrals`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    document.getElementById('totalReferrals').textContent = result.data.totalReferrals;
                    document.getElementById('referralCodeDisplay').value = result.data.referralCode;
                    
                    // Display referral list
                    const referralList = document.getElementById('referralList');
                    if (result.data.referrals && result.data.referrals.length > 0) {
                        let html = '';
                        result.data.referrals.forEach(referral => {
                            const date = new Date(referral.createdAt).toLocaleDateString();
                            html += `
                                <div class="transaction-item">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div>
                                            <h6 class="mb-1">${referral.username}</h6>
                                            <small class="text-muted">${referral.email}  Joined ${date}</small>
                                        </div>
                                        <div class="text-end">
                                            <div class="fw-bold">$${referral.totalInvested ? referral.totalInvested.toFixed(2) : '0.00'}</div>
                                            <small class="text-muted">Invested</small>
                                        </div>
                                    </div>
                                </div>
                            `;
                        });
                        referralList.innerHTML = html;
                    } else {
                        referralList.innerHTML = '<p class="text-muted">No referrals yet</p>';
                    }
                }
            } catch (error) {
                console.error('Error loading referrals:', error);
            }
        }

        // Load active investments
        async function loadActiveInvestments() {
            try {
                const response = await fetch(`${API_BASE_URL}/user/investments`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    displayActiveInvestments(result.data);
                }
            } catch (error) {
                console.error('Error loading investments:', error);
            }
        }

        // Display active investments
        function displayActiveInvestments(investments) {
            const container = document.getElementById('activeInvestments');
            
            if (!investments || investments.length === 0) {
                container.innerHTML = '<p class="text-muted">No active investments</p>';
                return;
            }
            
            let html = '';
            investments.forEach(investment => {
                const startDate = new Date(investment.startDate).toLocaleDateString();
                const endDate = investment.endDate ? new Date(investment.endDate).toLocaleDateString() : 'N/A';
                const profitEarned = investment.totalProfitEarned || 0;
                
                html += `
                    <div class="transaction-item">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <h6 class="mb-1">${investment.planName}</h6>
                                <small class="text-muted">Started: ${startDate}  Ends: ${endDate}</small>
                            </div>
                            <div class="text-end">
                                <div class="fw-bold">$${investment.amount.toFixed(2)}</div>
                                <small class="text-success">+$${profitEarned.toFixed(2)} earned</small>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Load profile data
        function loadProfileData() {
            if (currentUser) {
                document.getElementById('profileName').value = currentUser.name || '';
                document.getElementById('profileEmail').value = currentUser.email || '';
                document.getElementById('profileBitcoin').value = currentUser.bitcoinAccount || '';
                document.getElementById('profileTether').value = currentUser.tetherTRC20Account || '';
                document.getElementById('securityQuestion').value = currentUser.secretQuestion || '';
            }
        }

        // Show admin login modal
        function showAdminLogin() {
            const modal = new bootstrap.Modal(document.getElementById('adminLoginModal'));
            modal.show();
        }

        // ================== EVENT LISTENERS ==================

        // Setup event listeners
        function setupEventListeners() {
            // Login form submission
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            
            // Admin login form submission
            document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
            
            // Register form submission
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            
            // Forgot password form submission
            document.getElementById('forgotPasswordForm').addEventListener('submit', handleForgotPassword);
            
            // Deposit form submission
            document.getElementById('depositForm').addEventListener('submit', handleDeposit);
            
            // Withdrawal form submission
            document.getElementById('withdrawalForm').addEventListener('submit', handleWithdrawal);
            
            // Investment form submission
            document.getElementById('investmentForm').addEventListener('submit', handleInvestment);
            
            // Profile form submission
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
            
            // Password form submission
            document.getElementById('passwordForm').addEventListener('submit', handlePasswordChange);
            
            // Security form submission
            document.getElementById('securityForm').addEventListener('submit', handleSecurityUpdate);
            
            // Admin message form submission
            if (document.getElementById('adminMessageForm')) {
                document.getElementById('adminMessageForm').addEventListener('submit', handleAdminMessage);
            }
            
            // Admin balance form submission
            document.getElementById('userBalanceForm').addEventListener('submit', handleAdminBalanceUpdate);
            
            // Admin profit form submission
            document.getElementById('addProfitForm').addEventListener('submit', handleAdminAddProfit);
            
            // Logout button
            logoutNavLink.addEventListener('click', handleLogout);
            
            // Check approved deposits button
            document.getElementById('checkApprovedDeposits').addEventListener('click', checkApprovedDeposits);
        }

        // ================== FORM HANDLERS ==================

        // Handle login
        async function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const alertEl = document.getElementById('loginAlert');
            
            try {
                const response = await fetch(`${API_BASE_URL}/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    authToken = result.data.token;
                    localStorage.setItem('authToken', authToken);
                    localStorage.setItem('isAdmin', 'false');
                    isAdmin = false;
                    currentUser = result.data.user;
                    updateDashboardData();
                    showPage('dashboard');
                    alertEl.className = 'alert d-none';
                    
                    // Initialize WebSocket after successful login
                    initializeWebSocket();
                } else {
                    alertEl.className = 'alert alert-danger';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                }
            } catch (error) {
                console.error('Login error:', error);
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'An error occurred during login. Please try again.';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle admin login
        async function handleAdminLogin(e) {
            e.preventDefault();
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            const alertEl = document.getElementById('adminLoginAlert');
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                // Successful admin login
                localStorage.setItem('isAdmin', 'true');
                isAdmin = true;
                authToken = null;
                currentUser = null;
                
                // Close the modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('adminLoginModal'));
                modal.hide();
                
                // Show admin dashboard
                showPage('adminDashboard');
                alertEl.className = 'alert d-none';
            } else {
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'Invalid admin credentials';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle registration
        async function handleRegister(e) {
            e.preventDefault();
            const formData = {
                username: document.getElementById('username').value,
                name: document.getElementById('name').value,
                email: document.getElementById('registerEmail').value,
                password: document.getElementById('registerPassword').value,
                confirmPassword: document.getElementById('confirmPassword').value,
                secretQuestion: document.getElementById('secretQuestion').value,
                secretAnswer: document.getElementById('secretAnswer').value,
                bitcoinAccount: document.getElementById('bitcoinAccount').value || undefined,
                tetherTRC20Account: document.getElementById('tetherTRC20Account').value || undefined,
                referralCode: document.getElementById('referralCode').value || undefined,
                agreedToTerms: document.getElementById('agreeTerms').checked
            };
            
            const alertEl = document.getElementById('registerAlert');
            
            try {
                const response = await fetch(`${API_BASE_URL}/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Successful registration - redirect to login page
                    alertEl.className = 'alert alert-success';
                    alertEl.textContent = 'Registration successful! Please login with your credentials.';
                    alertEl.classList.remove('d-none');
                    
                    // Clear form
                    document.getElementById('registerForm').reset();
                    
                    // Redirect to login page after 2 seconds
                    setTimeout(() => {
                        showPage('login');
                        alertEl.classList.add('d-none');
                    }, 2000);
                } else {
                    alertEl.className = 'alert alert-danger';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                }
            } catch (error) {
                console.error('Registration error:', error);
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'An error occurred during registration. Please try again.';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle forgot password
        async function handleForgotPassword(e) {
            e.preventDefault();
            const email = document.getElementById('forgotEmail').value;
            const secretAnswer = document.getElementById('securityAnswer').value;
            const alertEl = document.getElementById('forgotPasswordAlert');
            
            try {
                const response = await fetch(`${API_BASE_URL}/forgot-password`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, secretAnswer })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alertEl.className = 'alert alert-success';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                    // Reset form after 3 seconds
                    setTimeout(() => {
                        document.getElementById('forgotPasswordForm').reset();
                        bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal')).hide();
                        alertEl.classList.add('d-none');
                    }, 3000);
                } else {
                    alertEl.className = 'alert alert-danger';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                }
            } catch (error) {
                console.error('Forgot password error:', error);
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'An error occurred. Please try again.';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle deposit
        async function handleDeposit(e) {
            e.preventDefault();
            const amount = document.getElementById('depositAmount').value;
            const method = document.getElementById('depositMethod').value;
            const proofFile = document.getElementById('depositProof').files[0];
            const alertEl = document.getElementById('depositAlert');
            
            if (!proofFile) {
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'Please select a proof of payment file.';
                alertEl.classList.remove('d-none');
                return;
            }
            
            const formData = new FormData();
            formData.append('amount', amount);
            formData.append('walletAddress', method);
            formData.append('proof', proofFile);
            
            try {
                const response = await fetch(`${API_BASE_URL}/deposits`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alertEl.className = 'alert alert-success';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                    // Reset form and close modal after 2 seconds
                    setTimeout(() => {
                        document.getElementById('depositForm').reset();
                        bootstrap.Modal.getInstance(document.getElementById('depositModal')).hide();
                        alertEl.classList.add('d-none');
                        // Refresh user data
                        fetchUserData();
                    }, 2000);
                } else {
                    alertEl.className = 'alert alert-danger';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                }
            } catch (error) {
                console.error('Deposit error:', error);
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'An error occurred during deposit submission. Please try again.';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle withdrawal
        async function handleWithdrawal(e) {
            e.preventDefault();
            const amount = document.getElementById('withdrawalAmount').value;
            const method = document.getElementById('withdrawalMethod').value;
            const walletAddress = document.getElementById('withdrawalWallet').value;
            const alertEl = document.getElementById('withdrawalAlert');
            
            try {
                const response = await fetch(`${API_BASE_URL}/withdrawals`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        amount, 
                        walletAddress: `${method}: ${walletAddress}` 
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alertEl.className = 'alert alert-success';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                    // Reset form and close modal after 2 seconds
                    setTimeout(() => {
                        document.getElementById('withdrawalForm').reset();
                        bootstrap.Modal.getInstance(document.getElementById('withdrawalModal')).hide();
                        alertEl.classList.add('d-none');
                        // Refresh user data
                        fetchUserData();
                    }, 2000);
                } else {
                    alertEl.className = 'alert alert-danger';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                }
            } catch (error) {
                console.error('Withdrawal error:', error);
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'An error occurred during withdrawal submission. Please try again.';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle investment
        async function handleInvestment(e) {
            e.preventDefault();
            const planId = document.getElementById('investmentPlan').value;
            const amount = document.getElementById('investmentAmount').value;
            const alertEl = document.getElementById('investmentAlert');
            
            try {
                const response = await fetch(`${API_BASE_URL}/investments`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ planId, amount })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alertEl.className = 'alert alert-success';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                    // Reset form and close modal after 2 seconds
                    setTimeout(() => {
                        document.getElementById('investmentForm').reset();
                        bootstrap.Modal.getInstance(document.getElementById('investmentModal')).hide();
                        alertEl.classList.add('d-none');
                        // Refresh user data and investments
                        fetchUserData();
                        loadActiveInvestments();
                    }, 2000);
                } else {
                    alertEl.className = 'alert alert-danger';
                    alertEl.textContent = result.message;
                    alertEl.classList.remove('d-none');
                }
            } catch (error) {
                console.error('Investment error:', error);
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'An error occurred during investment submission. Please try again.';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle profile update
        async function handleProfileUpdate(e) {
            e.preventDefault();
            const formData = {
                name: document.getElementById('profileName').value,
                bitcoinAccount: document.getElementById('profileBitcoin').value,
                tetherTRC20Account: document.getElementById('profileTether').value
            };
            
            try {
                const response = await fetch(`${API_BASE_URL}/user/profile`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Show success message
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'alert alert-success mt-3';
                    alertDiv.textContent = 'Profile updated successfully';
                    document.getElementById('profileForm').appendChild(alertDiv);
                    
                    setTimeout(() => {
                        alertDiv.remove();
                    }, 3000);
                    
                    // Update current user data
                    currentUser = { ...currentUser, ...formData };
                }
            } catch (error) {
                console.error('Profile update error:', error);
            }
        }

        // Handle password change
        async function handlePasswordChange(e) {
            e.preventDefault();
            const formData = {
                currentPassword: document.getElementById('currentPassword').value,
                newPassword: document.getElementById('newPassword').value,
                confirmNewPassword: document.getElementById('confirmNewPassword').value
            };
            
            try {
                const response = await fetch(`${API_BASE_URL}/user/change-password`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Show success message
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'alert alert-success mt-3';
                    alertDiv.textContent = 'Password changed successfully';
                    document.getElementById('passwordForm').appendChild(alertDiv);
                    
                    // Clear form
                    document.getElementById('passwordForm').reset();
                    
                    setTimeout(() => {
                        alertDiv.remove();
                    }, 3000);
                }
            } catch (error) {
                console.error('Password change error:', error);
            }
        }

        // Handle security update
        async function handleSecurityUpdate(e) {
            e.preventDefault();
            const formData = {
                secretQuestion: document.getElementById('securityQuestion').value,
                secretAnswer: document.getElementById('securityAnswer').value
            };
            
            try {
                const response = await fetch(`${API_BASE_URL}/user/profile`, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Show success message
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'alert alert-success mt-3';
                    alertDiv.textContent = 'Security settings updated successfully';
                    document.getElementById('securityForm').appendChild(alertDiv);
                    
                    setTimeout(() => {
                        alertDiv.remove();
                    }, 3000);
                }
            } catch (error) {
                console.error('Security update error:', error);
            }
        }

        // Handle admin message
        async function handleAdminMessage(e) {
            e.preventDefault();
            const recipients = Array.from(document.getElementById('messageRecipients').selectedOptions)
                .map(option => option.value);
            const title = document.getElementById('messageTitle').value;
            const content = document.getElementById('messageContent').value;
            const isImportant = document.getElementById('messageImportant').checked;
            
            try {
                const response = await fetch(`${API_BASE_URL}/admin/message`, {
                    method: 'POST',
                    headers: {
                        'Admin-Username': ADMIN_CREDENTIALS.username,
                        'Admin-Password': ADMIN_CREDENTIALS.password,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        userIds: recipients,
                        title,
                        content,
                        isImportant
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Show success message
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'alert alert-success mt-3';
                    alertDiv.textContent = 'Message sent successfully';
                    document.getElementById('adminMessageForm').appendChild(alertDiv);
                    
                    // Clear form
                    document.getElementById('adminMessageForm').reset();
                    
                    setTimeout(() => {
                        alertDiv.remove();
                    }, 3000);
                }
            } catch (error) {
                console.error('Admin message error:', error);
            }
        }

        // Handle admin balance update
        async function handleAdminBalanceUpdate(e) {
            e.preventDefault();
            const userId = document.getElementById('balanceUserId').value;
            const walletBalance = document.getElementById('walletBalanceInput').value;
            const depositBalance = document.getElementById('depositBalanceInput').value;
            const totalInvested = document.getElementById('totalInvestedInput').value;
            const note = document.getElementById('balanceNote').value;
            const alertEl = document.getElementById('userBalanceAlert');
            
            try {
                const result = await updateUserBalancesAdmin(userId, walletBalance, depositBalance, totalInvested, note);
                
                if (result) {
                    alertEl.className = 'alert alert-success';
                    alertEl.textContent = 'User balances updated successfully';
                    alertEl.classList.remove('d-none');
                    
                    // Close modal after 2 seconds
                    setTimeout(() => {
                        bootstrap.Modal.getInstance(document.getElementById('userBalanceModal')).hide();
                        alertEl.classList.add('d-none');
                    }, 2000);
                } else {
                    alertEl.className = 'alert alert-danger';
                    alertEl.textContent = 'Failed to update balances';
                    alertEl.classList.remove('d-none');
                }
            } catch (error) {
                console.error('Balance update error:', error);
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'An error occurred during balance update';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle admin add profit
        async function handleAdminAddProfit(e) {
            e.preventDefault();
            const userId = document.getElementById('profitUserId').value;
            const amount = document.getElementById('profitAmount').value;
            const note = document.getElementById('profitNote').value;
            const alertEl = document.getElementById('addProfitAlert');
            
            try {
                const result = await addUserProfit(userId, amount, note);
                
                if (result) {
                    alertEl.className = 'alert alert-success';
                    alertEl.textContent = `Profit of $${amount} added successfully`;
                    alertEl.classList.remove('d-none');
                    
                    // Close modal after 2 seconds
                    setTimeout(() => {
                        bootstrap.Modal.getInstance(document.getElementById('addProfitModal')).hide();
                        alertEl.classList.add('d-none');
                    }, 2000);
                } else {
                    alertEl.className = 'alert alert-danger';
                    alertEl.textContent = 'Failed to add profit';
                    alertEl.classList.remove('d-none');
                }
            } catch (error) {
                console.error('Add profit error:', error);
                alertEl.className = 'alert alert-danger';
                alertEl.textContent = 'An error occurred while adding profit';
                alertEl.classList.remove('d-none');
            }
        }

        // Handle logout
        function handleLogout(e) {
            e.preventDefault();
            
            // Close WebSocket connection if open
            if (webSocket && webSocket.readyState === WebSocket.OPEN) {
                webSocket.close(1000, 'User logged out');
            }
            
            localStorage.removeItem('authToken');
            localStorage.removeItem('isAdmin');
            authToken = null;
            isAdmin = false;
            currentUser = null;
            showPage('home');
        }

        // Check for approved deposits
        async function checkApprovedDeposits() {
            try {
                const response = await fetch(`${API_BASE_URL}/user/check-approved-deposits`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    if (result.data.processedCount > 0) {
                        // Update balances
                        document.getElementById('walletBalance').textContent = result.data.walletBalance.toFixed(2);
                        document.getElementById('depositBalance').textContent = result.data.depositBalance.toFixed(2);
                        
                        // Show success message
                        showToast('success', result.message);
                    } else {
                        showToast('info', result.message);
                    }
                }
            } catch (error) {
                console.error('Error checking approved deposits:', error);
            }
        }

        // ================== ADMIN FUNCTIONS ==================

        function viewUserDetails(userId) {
            alert(`View user details for ID: ${userId}`);
            // This would typically open a modal with user details
        }

        function toggleUserBlock(userId, block) {
            if (block) {
                if (confirm('Are you sure you want to block this user?')) {
                    // This would typically make an API call to block the user
                    showToast('success', `User with ID: ${userId} has been blocked`);
                    loadAdminUsers(); // Refresh the user list
                }
            } else {
                if (confirm('Are you sure you want to unblock this user?')) {
                    // This would typically make an API call to unblock the user
                    showToast('success', `User with ID: ${userId} has been unblocked`);
                    loadAdminUsers(); // Refresh the user list
                }
            }
        }

        function approveTransaction(transactionId, type) {
            if (confirm(`Are you sure you want to approve this ${type}?`)) {
                // This would typically make an API call to approve the transaction
                showToast('success', `${type.charAt(0).toUpperCase() + type.slice(1)} with ID: ${transactionId} has been approved`);
                loadAdminTransactions(); // Refresh the transaction list
            }
        }

        function rejectTransaction(transactionId, type) {
            const reason = prompt('Enter reason for rejection:');
            if (reason !== null) {
                // This would typically make an API call to reject the transaction
                showToast('success', `${type.charAt(0).toUpperCase() + type.slice(1)} with ID: ${transactionId} has been rejected. Reason: ${reason}`);
                loadAdminTransactions(); // Refresh the transaction list
            }
        }

        function viewTransactionDetails(transactionId) {
            alert(`View transaction details for ID: ${transactionId}`);
            // This would typically open a modal with transaction details
        }
    </script>
</body>
</html>